# 内存管理

内存管理主要分为物理内存管理和虚拟内存管理两个部分，物理内存管理的对象是内存页，虚拟内存管理的对象是地址映射。

## 
OS01采用Higher Half Kernel内存布局，内核程序使用`0xffff800000000000`以上的虚拟地址。这要求链接脚本将内核程序的起始地址设置为`0xffff800000000000 + 0x100000`，即高地址的1M位移处。

引导器（Loader）将内核程序加载到物理地址`0x100000`处，并跳转到该地址执行。该地址存放的是内核执行头程序，内核执行头会立即加载位于物理地址`0x10100`处的页目录，并通过`lret`指令切换到虚拟地址`0xffff80000010000`附近继续执行。

因此进入c语言的`kernel_main`函数后，应尽早重映射帧缓冲区以便可以在屏幕上输出文字内容。